<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini Cellphones — Demo</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --primary:#0b6ef6;
      --muted:#6b7280;
      --bg:#f7f8fb;
      --card:#ffffff;
      --radius:12px;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:#0f1724;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
    }

    /* Header */
    header{
      background:linear-gradient(90deg,#fff 0%, #fbfdff 100%);
      padding:16px 20px;
      position:sticky;
      top:0;
      z-index:40;
      box-shadow:0 1px 6px rgba(16,24,40,0.06);
      display:flex;
      gap:16px;
      align-items:center;
    }
    .logo{
      display:flex; gap:12px; align-items:center;
    }
    .logo .square{
      width:44px; height:44px; border-radius:8px; background:var(--primary); color:white; font-weight:700; display:flex; align-items:center; justify-content:center; font-size:18px;
    }
    .search{
      flex:1;
      display:flex;
      gap:8px;
      align-items:center;
      max-width:900px;
    }
    .search input{
      flex:1;
      padding:12px 14px;
      border-radius:10px;
      border:1px solid #e6eefc;
      background:white;
      outline:none;
      font-size:14px;
    }
    .icon-btn{
      background:transparent;border:0;color:var(--primary);cursor:pointer;font-weight:600;padding:8px 10px;border-radius:8px;
    }

    /* Layout */
    .container{max-width:1200px;margin:20px auto;padding:0 20px}
    .hero{
      display:flex;
      gap:20px;
      margin-bottom:18px;
      align-items:center;
    }
    .hero-left{
      flex:1;
      background:linear-gradient(135deg,#eef6ff,#fff);
      padding:20px;border-radius:12px;
      display:flex;gap:14px;align-items:center;
    }
    .hero .title{font-size:20px;font-weight:700}
    .categories{
      display:flex;gap:10px;flex-wrap:wrap;
    }
    .cat{
      padding:8px 12px;background:white;border-radius:999px;border:1px solid #eef2ff;color:var(--muted);cursor:pointer;font-size:13px;
    }

    /* Main */
    .main{
      display:grid;
      grid-template-columns:260px 1fr;
      gap:20px;
    }
    @media (max-width:900px){
      .main{grid-template-columns:1fr; padding-bottom:80px}
      .sidebar{order:2}
    }
    .sidebar{
      background:var(--card); padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(12,20,40,0.03);
      height:max-content;
    }
    .filter-section{margin-bottom:14px}
    .filter-section h4{margin:0 0 8px 0;font-size:14px;color:#0f1724}

    /* Products */
    .products-grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:16px;
    }
    @media (max-width:1100px){ .products-grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:600px){ .products-grid{grid-template-columns:1fr} }

    .card{
      background:var(--card);
      border-radius:12px;
      padding:12px;
      box-shadow:0 6px 18px rgba(12,20,40,0.03);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .thumb{
      width:100%;
      height:180px;
      border-radius:10px;
      background-size:cover;
      background-position:center;
    }
    .product-title{font-weight:600;font-size:15px}
    .price{color:var(--primary);font-weight:700;font-size:16px}
    .meta{color:var(--muted);font-size:13px}

    .card .actions{display:flex;gap:8px;margin-top:auto}
    .btn{padding:8px 10px;border-radius:10px;border:0;cursor:pointer}
    .btn-outline{background:transparent;border:1px solid #e6eefc;color:var(--primary)}
    .btn-primary{background:var(--primary);color:white}

    /* Cart drawer */
    .cart-btn{
      position:relative;
    }
    .badge{
      position:absolute; right:-6px; top:-6px; background:#ff3b30;color:white;border-radius:999px;padding:4px 7px;font-size:12px;font-weight:700;
    }
    .drawer{
      position:fixed; right:20px; top:80px; width:340px; max-height:70vh; overflow:auto;
      background:var(--card); border-radius:12px; box-shadow:0 18px 50px rgba(2,6,23,0.2); padding:14px; z-index:80;
    }

    /* Modal */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(2,6,23,0.45); display:flex; align-items:center; justify-content:center; z-index:100;
    }
    .modal{
      width:960px; max-width:95%; background:white; border-radius:12px; display:flex; gap:18px; padding:18px; align-items:flex-start;
    }
    .modal .left{flex:1}
    .modal .right{width:320px}
    .close{background:transparent;border:0;font-size:20px;cursor:pointer;color:var(--muted)}

    footer{text-align:center;color:var(--muted);padding:28px 0;margin-top:28px}

    /* small helpers */
    .muted{color:var(--muted);font-size:13px}
    .chip{padding:6px 8px;border-radius:8px;background:#f3f7ff;border:1px solid #eef4ff;color:var(--primary);font-weight:600;font-size:13px}
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <div class="square">CP</div>
      <div style="display:flex;flex-direction:column;line-height:1">
        <div style="font-weight:700">Mini Cellphones</div>
        <div style="font-size:12px;color:var(--muted)">Demo shop</div>
      </div>
    </div>

    <div class="search" role="search">
      <input id="searchInput" placeholder="Tìm điện thoại, phụ kiện, tên model..." aria-label="Tìm kiếm sản phẩm" />
      <button class="icon-btn" id="searchBtn">Tìm</button>
    </div>

    <div style="display:flex;gap:8px;align-items:center">
      <button class="icon-btn" id="favoritesBtn">Yêu thích</button>
      <button class="icon-btn cart-btn" id="openCartBtn" aria-label="Mở giỏ hàng">
        Giỏ hàng <span class="badge" id="cartCount">0</span>
      </button>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-left">
        <div style="width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,#fff,#eef6ff);display:flex;align-items:center;justify-content:center;">
          <img src="https://images.unsplash.com/photo-1512496015851-a90fb38ba796?w=200&q=80" alt="phone" style="width:56px;height:56px;object-fit:cover;border-radius:8px" />
        </div>
        <div>
          <div class="title">Flash Sale - Giảm đến 30% mọi mẫu</div>
          <div class="muted">Miễn phí giao hàng với đơn trên 2,000,000₫ • Trả góp 0%</div>
          <div style="margin-top:8px" class="categories">
            <div class="cat">iPhone</div>
            <div class="cat">Samsung</div>
            <div class="cat">Xiaomi</div>
            <div class="cat">Phụ kiện</div>
          </div>
        </div>
      </div>
      <div style="flex-basis:320px;display:flex;align-items:center;justify-content:flex-end">
        <div style="background:linear-gradient(135deg,#fff,#f2fbff);padding:12px;border-radius:12px;text-align:right">
          <div style="font-weight:700">Giao nhanh 2h</div>
          <div class="muted">Tại khu vực nội thành</div>
        </div>
      </div>
    </section>

    <section class="main">
      <aside class="sidebar" aria-label="Bộ lọc">
        <div class="filter-section">
          <h4>Danh mục</h4>
          <div style="display:flex;flex-direction:column;gap:8px">
            <label><input type="checkbox" class="catFilter" value="phone" checked /> Điện thoại</label>
            <label><input type="checkbox" class="catFilter" value="accessory" checked /> Phụ kiện</label>
            <label><input type="checkbox" class="catFilter" value="watch" checked /> Đồng hồ</label>
          </div>
        </div>

        <div class="filter-section">
          <h4>Khoảng giá</h4>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="chip price-chip" data-min="0" data-max="2000000">Dưới 2tr</button>
            <button class="chip price-chip" data-min="2000000" data-max="7000000">2 - 7tr</button>
            <button class="chip price-chip" data-min="7000000" data-max="20000000">Trên 7tr</button>
            <button class="chip price-chip" data-min="0" data-max="999999999">Tất cả</button>
          </div>
        </div>

        <div class="filter-section">
          <h4>Sắp xếp</h4>
          <select id="sortSelect" style="width:100%;padding:8px;border-radius:8px;border:1px solid #eef2ff">
            <option value="relevance">Phù hợp nhất</option>
            <option value="price-asc">Giá: Thấp → Cao</option>
            <option value="price-desc">Giá: Cao → Thấp</option>
          </select>
        </div>
      </aside>

      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div><strong id="resultsCount">0</strong> sản phẩm</div>
          <div class="muted">Hiển thị nhanh — Click vào sản phẩm để xem chi tiết</div>
        </div>

        <div class="products-grid" id="productsGrid" aria-live="polite">
          <!-- product cards injected here -->
        </div>

        <div style="margin-top:16px;display:flex;justify-content:center">
          <button id="loadMore" class="btn">Xem thêm</button>
        </div>
      </div>
    </section>

    <!-- Cart Drawer (hidden until open) -->
    <div id="cartDrawer" style="display:none" role="dialog" aria-label="Giỏ hàng">
      <div class="drawer">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <strong>Giỏ hàng</strong>
          <button id="closeCart" class="close">✕</button>
        </div>
        <div id="cartItems"></div>
        <div style="border-top:1px dashed #eef2ff;margin-top:8px;padding-top:8px;display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="muted">Tổng tạm</div>
            <div id="cartTotal" style="font-weight:700">0₫</div>
          </div>
          <div>
            <button id="checkoutBtn" class="btn btn-primary">Mua hàng</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal detail -->
    <div id="modalRoot" style="display:none"></div>

    <footer>© Mini Cellphones — Demo. Code miễn phí để phát triển tiếp.</footer>
  </main>

  <script>
    /********* Sample product data *********/
    const productsDB = [
      {id:1, title:"iPhone 14 Pro Max 128GB", price:29990000, brand:"Apple", category:"phone", img:"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=800&q=60", rating:4.8},
      {id:2, title:"Samsung Galaxy S24 Ultra", price:27990000, brand:"Samsung", category:"phone", img:"https://images.unsplash.com/photo-1510557880182-3d4d3b0f7c9f?w=800&q=60", rating:4.7},
      {id:3, title:"Xiaomi Redmi Note 13", price:5490000, brand:"Xiaomi", category:"phone", img:"https://images.unsplash.com/photo-1511707171634-1d50b7b8f4f3?w=800&q=60", rating:4.2},
      {id:4, title:"AirPods Pro (2nd gen)", price:5990000, brand:"Apple", category:"accessory", img:"https://images.unsplash.com/photo-1606813902817-6b0f8f8a1f6b?w=800&q=60", rating:4.6},
      {id:5, title:"Đồng hồ Galaxy Watch 6", price:7490000, brand:"Samsung", category:"watch", img:"https://images.unsplash.com/photo-1516574187841-cb9cc2ca948b?w=800&q=60", rating:4.3},
      {id:6, title:"Ốp lưng iPhone 14 Pro", price:390000, brand:"Apple", category:"accessory", img:"https://images.unsplash.com/photo-1585386959984-a4155220266b?w=800&q=60", rating:4.1},
      {id:7, title:"OnePlus 12", price:19990000, brand:"OnePlus", category:"phone", img:"https://images.unsplash.com/photo-1566891007114-8e7f7c57460c?w=800&q=60", rating:4.4},
      {id:8, title:"Sạc nhanh 65W", price:450000, brand:"Baseus", category:"accessory", img:"https://images.unsplash.com/photo-1599566150163-29194dcaad36?w=800&q=60", rating:4.0},
      // ... bạn có thể thêm nhiều sản phẩm ở đây
    ];

    /********* State *********/
    let visible = []; // products currently shown
    let page = 1;
    const pageSize = 6;

    // cart: {id: qty}
    let cart = JSON.parse(localStorage.getItem('mini_cart') || "{}");

    /********* Utilities *********/
    function formatVND(n){
      return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + "₫";
    }

    function updateCartCount(){
      const count = Object.values(cart).reduce((s,q)=>s+q,0);
      document.getElementById('cartCount').textContent = count;
    }

    function saveCart(){ localStorage.setItem('mini_cart', JSON.stringify(cart)); updateCartCount(); renderCart(); }

    /********* Rendering products *********/
    function applyFiltersAndSort(){
      const q = document.getElementById('searchInput').value.trim().toLowerCase();
      const checkedCats = Array.from(document.querySelectorAll('.catFilter:checked')).map(i=>i.value);
      const priceChip = document.querySelector('.price-chip.active');
      let minP = 0, maxP = 999999999;
      if(priceChip){
        minP = +priceChip.dataset.min;
        maxP = +priceChip.dataset.max;
      }
      const sort = document.getElementById('sortSelect').value;

      let res = productsDB.filter(p=>{
        if(!checkedCats.includes(p.category)) return false;
        if(p.price < minP || p.price > maxP) return false;
        if(q){
          return (p.title + " " + p.brand).toLowerCase().includes(q);
        }
        return true;
      });

      if(sort === 'price-asc') res.sort((a,b)=>a.price-b.price);
      if(sort === 'price-desc') res.sort((a,b)=>b.price-a.price);

      return res;
    }

    function renderProducts(reset=false){
      if(reset) page = 1;
      const all = applyFiltersAndSort();
      const start = 0;
      const end = page * pageSize;
      visible = all.slice(start, end);

      const grid = document.getElementById('productsGrid');
      grid.innerHTML = '';
      for(const p of visible){
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <div class="thumb" style="background-image:url('${p.img}')"></div>
          <div class="product-title">${p.title}</div>
          <div class="meta">${p.brand} • <span>${p.rating} ★</span></div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="price">${formatVND(p.price)}</div>
            <div style="display:flex;gap:8px">
              <button class="btn btn-outline" data-id="${p.id}" data-action="view">Xem</button>
              <button class="btn btn-primary" data-id="${p.id}" data-action="add">Thêm</button>
            </div>
          </div>
        `;
        grid.appendChild(card);
      }

      document.getElementById('resultsCount').textContent = all.length;
      document.getElementById('loadMore').style.display = (visible.length < all.length) ? 'inline-block' : 'none';
    }

    /********* Product actions (view / add) *********/
    document.addEventListener('click', (e)=>{
      const actionBtn = e.target.closest('button[data-action]');
      if(actionBtn){
        const id = +actionBtn.dataset.id;
        const action = actionBtn.dataset.action;
        if(action === 'view') openModal(id);
        if(action === 'add') addToCart(id, 1);
      }
    });

    /********* Modal detail *********/
    function openModal(id){
      const p = productsDB.find(x=>x.id===id);
      const root = document.getElementById('modalRoot');
      root.style.display = 'block';
      root.innerHTML = `
        <div class="modal-backdrop" id="backdropModal">
          <div class="modal" role="dialog" aria-label="${p.title}">
            <div class="left">
              <div style="display:flex;gap:12px">
                <div style="flex:1">
                  <img src="${p.img}" alt="${p.title}" style="width:100%;border-radius:12px;object-fit:cover" />
                </div>
                <div style="width:180px">
                  <div style="font-weight:700">${p.title}</div>
                  <div class="muted">${p.brand}</div>
                  <div style="margin-top:8px;font-size:22px;color:var(--primary);font-weight:800">${formatVND(p.price)}</div>
                  <div style="margin-top:12px" class="muted">Tình trạng: Còn hàng</div>
                  <div style="margin-top:12px">
                    <button class="btn btn-primary" id="modalAdd" data-id="${p.id}">Thêm vào giỏ</button>
                    <button class="btn btn-outline" id="modalClose" style="margin-left:8px">Đóng</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="right">
              <div style="font-weight:700;margin-bottom:8px">Mô tả</div>
              <div class="muted">Đây là demo mô tả cho ${p.title}. Thông số kỹ thuật, chính sách bảo hành, và các tùy chọn mua hàng sẽ hiển thị ở đây.</div>
            </div>
          </div>
        </div>
      `;

      document.getElementById('backdropModal').addEventListener('click', (ev)=>{
        if(ev.target.id === 'backdropModal') closeModal();
      });
      document.getElementById('modalClose').addEventListener('click', closeModal);
      document.getElementById('modalAdd').addEventListener('click', (ev)=>{
        addToCart(+ev.target.dataset.id,1);
        closeModal();
      });
    }
    function closeModal(){
      const root = document.getElementById('modalRoot');
      root.style.display = 'none';
      root.innerHTML = '';
    }

    /********* Cart render & actions *********/
    function renderCart(){
      const container = document.getElementById('cartItems');
      if(!container) return;
      container.innerHTML = '';
      const ids = Object.keys(cart).map(k=>+k);
      if(ids.length === 0){
        container.innerHTML = '<div class="muted">Giỏ hàng trống</div>';
        document.getElementById('cartTotal').textContent = formatVND(0);
        return;
      }
      let total = 0;
      for(const id of ids){
        const qty = cart[id];
        const p = productsDB.find(x=>x.id===id);
        const row = document.createElement('div');
        row.style.display = 'flex';
        row.style.gap = '8px';
        row.style.marginBottom = '10px';
        row.innerHTML = `
          <img src="${p.img}" alt="${p.title}" style="width:64px;height:48px;object-fit:cover;border-radius:8px" />
          <div style="flex:1">
            <div style="font-weight:600">${p.title}</div>
            <div class="muted">${formatVND(p.price)} • x${qty}</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:6px;justify-content:center">
            <button class="btn" data-op="inc" data-id="${p.id}">＋</button>
            <button class="btn" data-op="dec" data-id="${p.id}">－</button>
          </div>
        `;
        container.appendChild(row);
        total += p.price * qty;
      }
      document.getElementById('cartTotal').textContent = formatVND(total);
    }

    document.addEventListener('click', (e)=>{
      const opBtn = e.target.closest('button[data-op]');
      if(opBtn){
        const id = +opBtn.dataset.id;
        const op = opBtn.dataset.op;
        if(op === 'inc') { cart[id] = (cart[id]||0)+1; saveCart(); }
        if(op === 'dec') { cart[id] = (cart[id]||0)-1; if(cart[id] <= 0) delete cart[id]; saveCart(); }
      }
    });

    function addToCart(id, qty=1){
      cart[id] = (cart[id] || 0) + qty;
      saveCart();
      // small feedback
      const btn = document.querySelector(`button[data-id="${id}"][data-action="add"]`);
      if(btn){
        btn.textContent = 'Đã thêm';
        setTimeout(()=>btn.textContent='Thêm',700);
      }
    }

    // open/close cart drawer
    document.getElementById('openCartBtn').addEventListener('click', ()=>{
      document.getElementById('cartDrawer').style.display = 'block';
    });
    document.getElementById('closeCart').addEventListener('click', ()=>{
      document.getElementById('cartDrawer').style.display = 'none';
    });
    document.getElementById('checkoutBtn').addEventListener('click', ()=>{
      alert('Demo: Chuyển tới trang thanh toán (chưa cài đặt).');
    });

    /********* Filters events *********/
    document.getElementById('searchBtn').addEventListener('click', ()=>renderProducts(true));
    document.getElementById('searchInput').addEventListener('keydown', (e)=>{ if(e.key === 'Enter') renderProducts(true); });

    document.querySelectorAll('.catFilter').forEach(cb => cb.addEventListener('change', ()=>renderProducts(true)));
    document.getElementById('sortSelect').addEventListener('change', ()=>renderProducts(true));

    document.querySelectorAll('.price-chip').forEach(ch => {
      ch.addEventListener('click', (e)=>{
        document.querySelectorAll('.price-chip').forEach(c=>c.classList.remove('active'));
        e.currentTarget.classList.add('active');
        renderProducts(true);
      });
    });
    // default activate "Tất cả"
    document.querySelector('.price-chip[data-max="999999999"]').classList.add('active');

    document.getElementById('loadMore').addEventListener('click', ()=>{
      page++;
      renderProducts(false);
    });

    // init
    updateCartCount();
    renderCart();
    renderProducts(true);
  </script>
</body>
</html>
